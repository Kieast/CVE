#include <sys/types.h>
#include <sys/mount.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/xattr.h>
#include <sys/syscall.h>

#include <dirent.h>
#include <errno.h>
#include <error.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
	unsigned char v0[8192];
	unsigned char v1[8192];
	char v2[] = ".";
	char v3[] = "foo";
	char v4[] = "foo/bar";
	char v5[] = "foo/bar/baz";
	char v6[] = "foo/bar/xattr";
	char v7[] = "foo/bar/acl";
	char v8[] = "foo/bar/æøå";
	char v9[] = "foo/bar/fifo";
	char v10[] = "foo/bar/hln";
	char v11[] = "foo/bar/sln";
	long v12;
	char v13[] = "./b4oi8pP3";
	char v14[] = "./Jfi4A8tt";
	char v15[] = "foo/bar/tdj4Py80";
	char v16[] = "./AfvqzaW1";
	char v17[] = "foo/bar/FrilkrbT";
	char v18[] = "./GfcNyA2y";
	unsigned char v19[92];
	memcpy(v19, "\x52\x54\xc7\x83\x15\xb5\x4c\x3b\xa3\xb2\x70\xdb\xdc\x5a\x78\x8f\xd1\x50\x5d\xb4\x6e\xd7\xa2\x48\x1f\xfb\xc8\xe0\xa6\x1c\xb1\xf8\xef\x79\x7c\x06\x2f\xc8\x41\x53\x7b\x31\xae\xd8\x0b\xa6\xe7\xdc\xf6\xc5\x11\xe4\x1d\xb3\xac\x3c\xaf\x75\x1d\xd6\x12\x4e\xcf\x81\xc7\xcc\x07\x77\x15\xc7\x4a\x91\xf8\x78\xe9\x04\x1f\x51\x60\x96\x17\x72\xfa\x34\xa5\xa8\xef\xd5\x9d\x0d\xac\x2f", 92);
	char v20[] = "system.posix_acl_default";
	char v21[] = "./GfcNyA2y/Q6DT6xCF";
	unsigned char v22[2];
	memcpy(v22, "\x8b\x27", 2);
	char v23[] = "security.ima";
	v12 = syscall(SYS_open, (long)v5, 2, 0);
	syscall(SYS_read, (long)v12, (long)v0, 2164);
	syscall(SYS_link, (long)v5, (long)v13);
	syscall(SYS_symlink, (long)v10, (long)v14);
	syscall(SYS_unlink, (long)v10);
	syscall(SYS_symlink, (long)v13, (long)v15);
	syscall(SYS_ftruncate, (long)v12, 4686);
	syscall(SYS_link, (long)v5, (long)v16);
	syscall(SYS_ftruncate, (long)v12, 1608);
	syscall(SYS_fdatasync, (long)v12);
	syscall(SYS_ftruncate, (long)v12, 820);
	syscall(SYS_fallocate, (long)v12, 65, 4452, 4931);
	syscall(SYS_unlink, (long)v7);
	syscall(SYS_rename, (long)v13, (long)v17);
	syscall(SYS_truncate, (long)v3, 4391);
	syscall(SYS_rename, (long)v3, (long)v18);
	syscall(SYS_pwrite64, (long)v12, (long)v1, 7111, 3778);
	syscall(SYS_setxattr, (long)v8, (long)v20, (long)v19, 92, 1);
	syscall(SYS_fsync, (long)v12);
	syscall(SYS_write, (long)v12, (long)v1, 661);
	syscall(SYS_fsync, (long)v12);
	syscall(SYS_unlink, (long)v5);
	syscall(SYS_syncfs, (long)v12);
	syscall(SYS_symlink, (long)v18, (long)v21);
	syscall(SYS_setxattr, (long)v11, (long)v23, (long)v22, 2, 1);
	syscall(SYS_readlink, (long)v21, (long)v1, 8192);

	close(v12);
	return 0;
}
/* Active fds: v12 */
/* Files
Path: .
Type: dir
Xattrs: 
Path: ./AfvqzaW1
Type: file
Xattrs: 
Path: foo/bar/FrilkrbT
Type: file
Xattrs: 
Path: foo/bar/tdj4Py80
Type: symlink
Xattrs: 
Path: foo/bar/sln
Type: symlink
Xattrs: 
name: \x73\x65\x63\x75\x72\x69\x74\x79\x2e\x69\x6d\x61\x00
Path: foo/bar/æøå
Type: file
Xattrs: 
name: \x73\x79\x73\x74\x65\x6d\x2e\x70\x6f\x73\x69\x78\x5f\x61\x63\x6c\x5f\x64\x65\x66\x61\x75\x6c\x74\x00
Path: foo/bar/fifo
Type: fifo
Xattrs: 
Path: ./GfcNyA2y
Type: dir
Xattrs: 
Path: ./Jfi4A8tt
Type: symlink
Xattrs: 
Path: foo/bar
Type: dir
Xattrs: 
Path: foo/bar/xattr
Type: file
Xattrs: 
Path: ./GfcNyA2y/Q6DT6xCF
Type: symlink
Xattrs: 
*/
