#include <sys/types.h>
#include <sys/mount.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/xattr.h>
#include <sys/syscall.h>

#include <dirent.h>
#include <errno.h>
#include <error.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
	unsigned char v0[8192];
	unsigned char v1[8192];
	char v2[] = ".";
	char v3[] = "foo";
	char v4[] = "foo/bar";
	char v5[] = "foo/bar/baz";
	char v6[] = "foo/bar/xattr";
	char v7[] = "foo/bar/acl";
	char v8[] = "foo/bar/æøå";
	char v9[] = "foo/bar/fifo";
	char v10[] = "foo/bar/hln";
	char v11[] = "foo/bar/sln";
	long v12;
	char v13[] = "trusted.cokg2RgG";
	char v14[] = "foo/bar/nQx79Gce";
	char v15[] = "foo/bar/0v0exRKB";
	long v16;
	long v17;
	char v18[] = "foo/XimBK6et";
	long v19;
	char v20[] = "./tF2SAteE";
	v12 = syscall(SYS_open, (long)v2, 65536, 0);
	syscall(SYS_getdents64, (long)v12, (long)v1, 2344);
	syscall(SYS_removexattr, (long)v3, (long)v13);
	syscall(SYS_rename, (long)v10, (long)v3);
	syscall(SYS_unlink, (long)v6);
	syscall(SYS_link, (long)v2, (long)v14);
	v16 = syscall(SYS_open, (long)v15, 66, 438);
	syscall(SYS_lseek, (long)v16, 2648, 2);
	syscall(SYS_lseek, (long)v16, 1244, 4);
	syscall(SYS_syncfs, (long)v16);
	syscall(SYS_write, (long)v16, (long)v1, 4286);
	syscall(SYS_fsync, (long)v16);
	syscall(SYS_pwrite64, (long)v16, (long)v1, 233, 2592);
	syscall(SYS_fdatasync, (long)v16);
	v17 = syscall(SYS_open, (long)v8, 2, 0);
	syscall(SYS_syncfs, (long)v17);
	syscall(SYS_read, (long)v17, (long)v0, 2848);
	v19 = syscall(SYS_open, (long)v18, 66, 438);
	syscall(SYS_readlink, (long)v11, (long)v1, 8192);
	syscall(SYS_fsync, (long)v17);
	syscall(SYS_unlink, (long)v8);
	syscall(SYS_unlink, (long)v9);
	syscall(SYS_pwrite64, (long)v16, (long)v1, 2810, 6197);
	syscall(SYS_fsync, (long)v19);
	syscall(SYS_fsync, (long)v16);
	syscall(SYS_read, (long)v16, (long)v0, 4766);
	syscall(SYS_symlink, (long)v2, (long)v20);
	syscall(SYS_fallocate, (long)v19, 65, 1765, 4751);
	syscall(SYS_read, (long)v16, (long)v0, 7284);
	syscall(SYS_readlink, (long)v7, (long)v1, 8192);

	close(v12);
	close(v16);
	close(v17);
	close(v19);
	return 0;
}
/* Active fds: v12 v16 v17 v19 */
/* Files
Path: .
Type: dir
Xattrs: 
Path: foo/bar/0v0exRKB
Type: file
Xattrs: 
Path: foo/bar/sln
Type: symlink
Xattrs: 
Path: foo/bar/acl
Type: file
Xattrs: 
Path: foo/bar/nQx79Gce
Type: dir
Xattrs: 
Path: foo
Type: file
Xattrs: 
Path: foo/bar/baz
Type: file
Xattrs: 
Path: foo/bar
Type: dir
Xattrs: 
Path: foo
Type: dir
Xattrs: 
Path: foo/XimBK6et
Type: file
Xattrs: 
Path: ./tF2SAteE
Type: symlink
Xattrs: 
*/
