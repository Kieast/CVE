#include <sys/types.h>
#include <sys/mount.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/xattr.h>
#include <sys/syscall.h>

#include <dirent.h>
#include <errno.h>
#include <error.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
	unsigned char v0[8192];
	unsigned char v1[8192];
	char v2[] = ".";
	char v3[] = "foo";
	char v4[] = "foo/bar";
	char v5[] = "foo/bar/baz";
	char v6[] = "foo/bar/xattr";
	char v7[] = "foo/bar/acl";
	char v8[] = "foo/bar/æøå";
	char v9[] = "foo/bar/fifo";
	char v10[] = "foo/bar/hln";
	char v11[] = "foo/bar/sln";
	long v12;
	char v13[] = "./b4oi8pP3";
	char v14[] = "./Jfi4A8tt";
	char v15[] = "foo/bar/tdj4Py80";
	char v16[] = "./AfvqzaW1";
	char v17[] = "./EvL12tth";
	long v18;
	char v19[] = "foo/YGlOLac2";
	char v20[] = "system.advise";
	char v21[] = "foo/bar/MV9AOPU6";
	char v22[] = "foo/bar/MV9AOPU6/3r1cRxml";
	char v23[] = "./EvL12tth/gXMjGK9D";
	long v24;
	char v25[] = "foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV";
	char v26[] = "system.advise";
	char v27[] = "./8SDE2w9R";
	char v28[] = "foo/bar/MV9AOPU6/3p7I5040";
	char v29[] = "foo/bar/MV9AOPU6/3p7I5040/TvfxYv2W";
	char v30[] = "foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV/d9VKpuaQ";
	char v31[] = "foo/bar/MV9AOPU6/ESVGSRIl";
	char v32[] = "foo/bar/eBeC4hjK";
	char v33[] = "security.capability";
	char v34[] = "trusted.sslab";
	char v35[] = "foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV/sob550O1";
	unsigned char v36[3];
	memcpy(v36, "\x2c\xb2\xfb", 3);
	char v37[] = "security.cgRZj85E";
	char v38[] = "security.pZntXY45";
	char v39[] = "security.xnc20hFU";
	unsigned char v40[26];
	memcpy(v40, "\x63\xf2\x9e\x99\xb1\x78\xf7\x90\x01\xd4\x03\xf9\xe2\xef\x1f\x08\xef\xf3\x8c\x64\x89\x1f\x59\xfe\x53\x7e", 26);
	char v41[] = "security.capability";
	char v42[] = "foo/bar/MV9AOPU6/3r1cRxml/XljnrSIy";
	char v43[] = "foo/bar/eBeC4hjK/T2GydQO0";
	v12 = syscall(SYS_open, (long)v5, 2, 0);
	syscall(SYS_read, (long)v12, (long)v0, 2164);
	syscall(SYS_link, (long)v5, (long)v13);
	syscall(SYS_symlink, (long)v10, (long)v14);
	syscall(SYS_unlink, (long)v10);
	syscall(SYS_symlink, (long)v13, (long)v15);
	syscall(SYS_ftruncate, (long)v12, 4686);
	syscall(SYS_link, (long)v5, (long)v16);
	syscall(SYS_ftruncate, (long)v12, 4292);
	syscall(SYS_fdatasync, (long)v12);
	syscall(SYS_mkdir, (long)v17);
	syscall(SYS_readlink, (long)v5, (long)v1, 8192);
	v18 = syscall(SYS_open, (long)v7, 2, 0);
	syscall(SYS_mkdir, (long)v19);
	syscall(SYS_removexattr, (long)v4, (long)v20);
	syscall(SYS_readlink, (long)v7, (long)v1, 8192);
	syscall(SYS_ftruncate, (long)v18, 1587);
	syscall(SYS_write, (long)v18, (long)v1, 436);
	syscall(SYS_fdatasync, (long)v18);
	syscall(SYS_mkdir, (long)v21);
	syscall(SYS_pwrite64, (long)v12, (long)v1, 66, 1584);
	syscall(SYS_link, (long)v17, (long)v22);
	v24 = syscall(SYS_open, (long)v23, 66, 438);
	syscall(SYS_write, (long)v24, (long)v1, 4575);
	syscall(SYS_mkdir, (long)v25);
	syscall(SYS_pread64, (long)v12, (long)v0, 7795, 5178);
	syscall(SYS_removexattr, (long)v9, (long)v26);
	syscall(SYS_rmdir, (long)v17);
	syscall(SYS_fdatasync, (long)v12);
	syscall(SYS_symlink, (long)v5, (long)v27);
	syscall(SYS_fdatasync, (long)v24);
	syscall(SYS_rmdir, (long)v19);
	syscall(SYS_ftruncate, (long)v24, 4477);
	syscall(SYS_truncate, (long)v16, 4656);
	syscall(SYS_mkdir, (long)v28);
	syscall(SYS_readlink, (long)v3, (long)v1, 8192);
	syscall(SYS_mkdir, (long)v29);
	syscall(SYS_link, (long)v11, (long)v30);
	syscall(SYS_symlink, (long)v13, (long)v31);
	syscall(SYS_mkdir, (long)v32);
	syscall(SYS_readlink, (long)v4, (long)v1, 8192);
	syscall(SYS_removexattr, (long)v2, (long)v33);
	syscall(SYS_ftruncate, (long)v24, 1002);
	syscall(SYS_rmdir, (long)v29);
	syscall(SYS_rename, (long)v16, (long)v31);
	syscall(SYS_removexattr, (long)v11, (long)v34);
	syscall(SYS_truncate, (long)v6, 7680);
	syscall(SYS_link, (long)v7, (long)v35);
	syscall(SYS_pwrite64, (long)v18, (long)v1, 775, 7892);
	syscall(SYS_rmdir, (long)v28);
	syscall(SYS_write, (long)v24, (long)v1, 7237);
	syscall(SYS_rmdir, (long)v3);
	syscall(SYS_setxattr, (long)v13, (long)v37, (long)v36, 3, 1);
	syscall(SYS_removexattr, (long)v6, (long)v38);
	syscall(SYS_lseek, (long)v18, 1881, 3);
	syscall(SYS_write, (long)v12, (long)v1, 5521);
	syscall(SYS_chmod, (long)v6, 3072);
	syscall(SYS_removexattr, (long)v5, (long)v39);
	syscall(SYS_truncate, (long)v7, 25);
	syscall(SYS_fdatasync, (long)v24);
	syscall(SYS_setxattr, (long)v11, (long)v41, (long)v40, 26, 1);
	syscall(SYS_fallocate, (long)v18, 65, 5841, 4491);
	syscall(SYS_syncfs, (long)v18);
	syscall(SYS_link, (long)v35, (long)v42);
	syscall(SYS_symlink, (long)v23, (long)v43);
	syscall(SYS_readlink, (long)v42, (long)v1, 8192);

	close(v12);
	close(v18);
	close(v24);
	return 0;
}
/* Active fds: v12 v18 v24 */
/* Files
Path: .
Type: dir
Xattrs: 
Path: foo/bar/baz
Type: file
Xattrs: 
Path: ./Jfi4A8tt
Type: symlink
Xattrs: 
Path: foo/bar/xattr
Type: file
Xattrs: 
Path: foo/bar/tdj4Py80
Type: symlink
Xattrs: 
Path: foo/bar/MV9AOPU6
Type: dir
Xattrs: 
Path: foo/bar/acl
Type: file
Xattrs: 
Path: foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV/sob550O1
Type: file
Xattrs: 
Path: ./8SDE2w9R
Type: symlink
Xattrs: 
Path: foo/bar/MV9AOPU6/ESVGSRIl
Type: symlink
Xattrs: 
Path: foo/bar/æøå
Type: file
Xattrs: 
Path: foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV
Type: dir
Xattrs: 
Path: ./b4oi8pP3
Type: file
Xattrs: 
name: \x73\x65\x63\x75\x72\x69\x74\x79\x2e\x63\x67\x52\x5a\x6a\x38\x35\x45\x00
Path: foo/bar/sln
Type: symlink
Xattrs: 
name: \x73\x65\x63\x75\x72\x69\x74\x79\x2e\x63\x61\x70\x61\x62\x69\x6c\x69\x74\x79\x00
Path: foo/bar/MV9AOPU6/3r1cRxml
Type: dir
Xattrs: 
Path: foo/bar
Type: dir
Xattrs: 
Path: foo/bar/MV9AOPU6/3r1cRxml/hqjfvnaV/d9VKpuaQ
Type: symlink
Xattrs: 
Path: foo/bar/eBeC4hjK
Type: dir
Xattrs: 
Path: ./EvL12tth/gXMjGK9D
Type: file
Xattrs: 
Path: foo/bar/fifo
Type: fifo
Xattrs: 
Path: foo/bar/MV9AOPU6/ESVGSRIl
Type: file
Xattrs: 
Path: foo/bar/MV9AOPU6/3r1cRxml/XljnrSIy
Type: file
Xattrs: 
Path: foo/bar/eBeC4hjK/T2GydQO0
Type: symlink
Xattrs: 
*/
