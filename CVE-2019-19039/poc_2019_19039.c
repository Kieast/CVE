
#include <sys/types.h>
#include <sys/mount.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/xattr.h>
#include <sys/syscall.h>

#include <dirent.h>
#include <errno.h>
#include <error.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
	unsigned char v0[8192];
	unsigned char v1[8192];
	char v2[] = ".";
	char v3[] = "foo";
	char v4[] = "foo/bar";
	char v5[] = "foo/bar/baz";
	char v6[] = "foo/bar/xattr";
	char v7[] = "foo/bar/acl";
	char v8[] = "foo/bar/æøå";
	char v9[] = "foo/bar/fifo";
	char v10[] = "foo/bar/hln";
	char v11[] = "foo/bar/sln";
	long v12;
	unsigned char v13[46];
	memcpy(v13, "\x5e\xdb\x75\xb9\x70\x0d\x11\xaf\x02\x75\x99\x37\x7b\xbd\x58\x47\x78\x48\x35\x85\x85\xcb\xdf\xdf\xe3\x4d\x7a\x9d\x70\x7c\xec\xce\x59\xe1\x08\x49\xee\x99\x79\xf0\x0f\x92\xa7\x0b\x50\x01", 46);
	char v14[] = "security.selinux";
	char v15[] = "security.evm";
	char v16[] = "foo/bar/Z9p1Tj6B";
	long v17;
	char v18[] = "foo/lkqZPn8G";
	char v19[] = "./I8xopa9K";
	char v20[] = "foo/bar/dKkeTIlz";
	char v21[] = "./W1Lr86ls";
	unsigned char v22[97];
	memcpy(v22, "\x0a\xae\x8e\x35\x15\xbb\xfd\x9b\xe7\xf7\x5b\xe2\x8f\x37\x66\x75\x67\x79\xf2\xc1\xea\x21\x9f\x4d\x84\x07\x10\x3e\xeb\xd3\x66\xf5\x82\x75\xab\x98\x31\xa9\xb3\x98\x22\x8f\x7b\x31\xc6\x61\x26\xae\x5a\x1a\x70\xc4\xba\x10\x13\x3f\x18\xa2\xfc\x04\x77\x64\x7a\xf9\x59\xa5\x12\x0a\x4f\xc6\xa2\xf0\x56\x9d\x23\x9c\xfe\x49\x4b\xd8\xe2\x3b\x9e\x9d\x4c\x31\x5d\xe3\xd3\x5a\x67\x4b\x3e\xe1\xc5\x17\x87", 97);
	char v23[] = "security.4Agb7Tg2";
	unsigned char v24[28];
	memcpy(v24, "\xd7\x35\xe4\x88\x12\x48\x5c\xeb\xaf\x28\x2b\x12\xed\x42\x19\x45\xe3\x70\xe4\x27\xb8\xd8\x09\x23\x6a\x68\x57\x48", 28);
	char v25[] = "user.iqfdjnqx";
	v12 = syscall(SYS_open, (long)v2, 65536, 0);
	syscall(SYS_getdents64, (long)v12, (long)v1, 2344);
	syscall(SYS_setxattr, (long)v10, (long)v14, (long)v13, 46, 1);
	syscall(SYS_unlink, (long)v6);
	syscall(SYS_removexattr, (long)v5, (long)v15);
	v17 = syscall(SYS_open, (long)v16, 66, 438);
	syscall(SYS_fdatasync, (long)v17);
	syscall(SYS_lseek, (long)v17, 3689, 2);
	syscall(SYS_rename, (long)v10, (long)v18);
	syscall(SYS_ftruncate, (long)v17, 6513);
	syscall(SYS_pwrite64, (long)v17, (long)v1, 4113, 5853);
	syscall(SYS_fsync, (long)v17);
	syscall(SYS_rmdir, (long)v3);
	syscall(SYS_unlink, (long)v5);
	syscall(SYS_ftruncate, (long)v17, 47);
	syscall(SYS_link, (long)v8, (long)v19);
	syscall(SYS_ftruncate, (long)v17, 1291);
	syscall(SYS_fallocate, (long)v17, 65, 1058, 2114);
	syscall(SYS_link, (long)v11, (long)v20);
	syscall(SYS_symlink, (long)v16, (long)v21);
	syscall(SYS_rmdir, (long)v4);
	syscall(SYS_syncfs, (long)v17);
	syscall(SYS_unlink, (long)v19);
	syscall(SYS_pwrite64, (long)v17, (long)v1, 6378, 7499);
	syscall(SYS_truncate, (long)v21, 4596);
	syscall(SYS_fsync, (long)v17);
	syscall(SYS_pwrite64, (long)v17, (long)v1, 1501, 5119);
	syscall(SYS_syncfs, (long)v17);
	syscall(SYS_rename, (long)v11, (long)v9);
	syscall(SYS_syncfs, (long)v17);
	syscall(SYS_write, (long)v17, (long)v1, 2497);
	syscall(SYS_ftruncate, (long)v17, 3212);
	syscall(SYS_fallocate, (long)v17, 65, 5079, 4717);
	syscall(SYS_unlink, (long)v9);
	syscall(SYS_write, (long)v17, (long)v1, 3895);
	syscall(SYS_setxattr, (long)v18, (long)v23, (long)v22, 97, 1);
	syscall(SYS_unlink, (long)v20);
	syscall(SYS_setxattr, (long)v9, (long)v25, (long)v24, 28, 1);
	syscall(SYS_pread64, (long)v17, (long)v0, 3350, 3647);
	syscall(SYS_rename, (long)v8, (long)v7);
	syscall(SYS_truncate, (long)v7, 4358);
	syscall(SYS_write, (long)v17, (long)v1, 685);

	close(v12);
	close(v17);
	return 0;
}
/* Active fds: v12 v17 */
/* Files
Path: .
Type: dir
Xattrs: 
Path: foo/bar/acl
Type: file
Xattrs: 
Path: foo/bar/fifo
Type: fifo
Xattrs: 
name: \x75\x73\x65\x72\x2e\x69\x71\x66\x64\x6a\x6e\x71\x78\x00
Path: foo/bar/acl
Type: file
Xattrs: 
Path: foo/bar/Z9p1Tj6B
Type: file
Xattrs: 
Path: ./W1Lr86ls
Type: symlink
Xattrs: 
Path: foo/lkqZPn8G
Type: file
Xattrs: 
name: \x73\x65\x63\x75\x72\x69\x74\x79\x2e\x73\x65\x6c\x69\x6e\x75\x78\x00
name: \x73\x65\x63\x75\x72\x69\x74\x79\x2e\x34\x41\x67\x62\x37\x54\x67\x32\x00
*/

